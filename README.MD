# SOCKS5 Proxy Server —Å —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–∞–≤–∏–ª

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π SOCKS5 –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞, —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –∫–∞—Å–∫–∞–¥–∏—Ä–æ–≤–∞–Ω–∏—è.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Java 17 –∏–ª–∏ –≤—ã—à–µ
- Gradle (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Gradle Wrapper)
- Linux/macOS (–¥–ª—è bash-—Å–∫—Ä–∏–ø—Ç–æ–≤)

### –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
```bash
./gradlew shadowJar
```

–ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π JAR —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤: `build/libs/net_6_socks-1.0-SNAPSHOT-all.jar`

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
```bash
# –§–æ—Ä–º–∞—Ç: java -jar <jar-file> <port> <default-strategy> [upstream-host] [upstream-port]
java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 direct
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|----------|--------|
| `port` | –ü–æ—Ä—Ç –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è | 1080 |
| `default-strategy` | –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | direct, redirect, segment |
| `upstream-host` | (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –•–æ—Å—Ç upstream –ø—Ä–æ–∫—Å–∏ | 127.0.0.1 |
| `upstream-port` | (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü–æ—Ä—Ç upstream –ø—Ä–æ–∫—Å–∏ | 9050 |

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞

```bash
# 1. –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 direct

# 2. –° —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 segment

# 3. –° –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ Tor
java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 redirect 127.0.0.1 9050
```

## üìã –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤–∏–ª

–ü—Ä–æ–∫—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 4 —Ç–∏–ø–∞ –ø—Ä–∞–≤–∏–ª –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–æ–º. –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞:

### 1. Blacklist (blacklist.txt)
**–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è**
- –ó–∞–ø—Ä–æ—Å—ã –∫ –¥–æ–º–µ–Ω–∞–º –∏–∑ —ç—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ–∫–ª–∞–º—ã, —Ç—Ä–µ–∫–µ—Ä–æ–≤, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Å–∞–π—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä—ã:**
```
doubleclick\.net
.*analytics\..*
badwebsite\.com
```

### 2. Whitelist (whitelist.txt)
**–ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**
- –ó–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä—ã:**
```
ya\.ru
yandex\.ru
mail\.ru
github\.com
```

### 3. Redirect (redirect.txt)
**–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ upstream –ø—Ä–æ–∫—Å–∏**
- –ó–∞–ø—Ä–æ—Å—ã –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –¥—Ä—É–≥–æ–π SOCKS5 —Å–µ—Ä–≤–µ—Ä
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–∞—Å–∫–∞–¥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∫—Å–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Tor)

**–ü—Ä–∏–º–µ—Ä—ã:**
```
.*\.onion
facebook\.com
rutracker\.org
```

### 4. Segment (segment.txt)
**–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞**
- –ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—é –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ö–∞–Ω–∏–∑–º —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—Ö–æ–¥–∞ DPI (Deep Packet Inspection)

**–ü—Ä–∏–º–µ—Ä—ã:**
```
web\.telegram\.org
.*vpn.*
netflix\.com
```

### –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤ –ø—Ä–∞–≤–∏–ª
- –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ = –æ–¥–Ω–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ (regex)
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `#`
- –†–µ–≥–∏—Å—Ç—Ä –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è (case-insensitive)
- –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å curl

#### 1. –¢–µ—Å—Ç whitelist (–ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
```bash
# –ó–∞–ø—Ä–æ—Å –∫ ya.ru (–¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ –Ω–∞–ø—Ä—è–º—É—é)
curl -x socks5h://127.0.0.1:1080 http://ya.ru

# –ó–∞–ø—Ä–æ—Å –∫ mail.ru (–¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ –Ω–∞–ø—Ä—è–º—É—é)
curl -x socks5h://127.0.0.1:1080 http://mail.ru
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[SESSION] ya.ru:80 -> strategy=direct, bytesSent=XXX, bytesReceived=XXX
```

#### 2. –¢–µ—Å—Ç blacklist (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)
```bash
# –ó–∞–ø—Ä–æ—Å –∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Å–∞–π—Ç—É
curl -x socks5h://127.0.0.1:1080 http://badwebsite.com

# –ó–∞–ø—Ä–æ—Å –∫ —Ä–µ–∫–ª–∞–º–Ω–æ–π —Å–µ—Ç–∏
curl -x socks5h://127.0.0.1:1080 http://doubleclick.net
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[SESSION] badwebsite.com:80 -> strategy=blacklist, bytesSent=0, bytesReceived=0
curl: (97) Recv failure: Connection reset by peer
```

#### 3. –¢–µ—Å—Ç segment (—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è)
```bash
# –ó–∞–ø—Ä–æ—Å –∫ —Å–∞–π—Ç—É —Å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π
curl -x socks5h://127.0.0.1:1080 http://segmentme.com

# Telegram Web
curl -x socks5h://127.0.0.1:1080 https://web.telegram.org
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[SESSION] segmentme.com:80 -> strategy=segment, bytesSent=XXX, bytesReceived=XXX
```

#### 4. –¢–µ—Å—Ç redirect (–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
**–í–∞–∂–Ω–æ:** –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è redirect –Ω—É–∂–µ–Ω –∑–∞–ø—É—â–µ–Ω–Ω—ã–π upstream –ø—Ä–æ–∫—Å–∏!

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–∫—Å–∏ —Å upstream (–Ω–∞–ø—Ä–∏–º–µ—Ä, Tor –Ω–∞ –ø–æ—Ä—Ç—É 9050)
java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 direct 127.0.0.1 9050

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
curl -x socks5h://127.0.0.1:1080 http://redirected.com
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[SESSION] redirected.com:80 -> strategy=redirect, bytesSent=XXX, bytesReceived=XXX
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ bash-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
chmod +x test-proxy.sh
./test-proxy.sh
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- ‚úÖ –í—Å–µ 4 —Ç–∏–ø–∞ –ø—Ä–∞–≤–∏–ª
- ‚úÖ –°—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –†–∞–±–æ—Ç—É —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–∞–π—Ç–∞–º–∏
- ‚úÖ HTTPS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞—Ñ–∏–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–∞–∫–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ tcpdump
```bash
# –í –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
sudo tcpdump -i lo port 1080 -v

# –ò–ª–∏ –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ
sudo tcpdump -i lo port 1080 -X -vv
```

### –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
–ü—Ä–æ–∫—Å–∏ –≤—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
[SESSION] <host>:<port> -> strategy=<strategy>, bytesSent=<bytes>, bytesReceived=<bytes>
```

–ü—Ä–∏–º–µ—Ä:
```
[SESSION] ya.ru:80 -> strategy=direct, bytesSent=89, bytesReceived=15234
[SESSION] badwebsite.com:80 -> strategy=blacklist, bytesSent=0, bytesReceived=0
[SESSION] segmentme.com:80 -> strategy=segment, bytesSent=124, bytesReceived=8932
```

## üìä –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–∫–ª–∞–º—ã –∏ —Ç—Ä–µ–∫–µ—Ä–æ–≤
```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ blacklist.txt:
# doubleclick\.net
# .*analytics\..*
# .*\.ads\..*

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–∫—Å–∏
java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 direct

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SOCKS5 proxy localhost:1080
# –†–µ–∫–ª–∞–º–∞ –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–∫—Å–∏
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –û–±—Ö–æ–¥ DPI –¥–ª—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤
```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ segment.txt:
# web\.telegram\.org
# whatsapp\.com

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 segment

# –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∑–∞—â–∏—Ç–æ–π –æ—Ç DPI
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–∞—Å–∫–∞–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Tor
```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Tor (–æ–±—ã—á–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É 9050)
# 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ redirect.txt —Å –Ω—É–∂–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–∫—Å–∏:
java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 direct 127.0.0.1 9050

# –ó–∞–ø—Ä–æ—Å—ã –∫ –¥–æ–º–µ–Ω–∞–º –∏–∑ redirect.txt –ø–æ–π–¥—É—Ç —á–µ—Ä–µ–∑ Tor
curl -x socks5h://127.0.0.1:1080 http://check.torproject.org
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞:
# - blacklist.txt: —Ä–µ–∫–ª–∞–º–∞ –∏ —Ç—Ä–µ–∫–µ—Ä—ã
# - whitelist.txt: —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ —Å–∞–π—Ç—ã (–ø—Ä—è–º–æ)
# - redirect.txt: —Å–æ—Ü—Å–µ—Ç–∏ (—á–µ—Ä–µ–∑ Tor)
# - segment.txt: –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã –∏ VPN (—Å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π)

java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 direct 127.0.0.1 9050
```

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞

### Firefox
1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –û—Å–Ω–æ–≤–Ω—ã–µ ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ç–∏ ‚Üí –ù–∞—Å—Ç—Ä–æ–∏—Ç—å
2. –í—ã–±–µ—Ä–∏—Ç–µ "–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–æ–∫—Å–∏"
3. SOCKS Host: `localhost`, Port: `1080`
4. –í—ã–±–µ—Ä–∏—Ç–µ "SOCKS v5"
5. –í–∫–ª—é—á–∏—Ç–µ "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏ DNS –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ SOCKS v5"

### Chrome/Chromium
```bash
# Linux
chromium --proxy-server="socks5://localhost:1080"

# macOS
open -a "Google Chrome" --args --proxy-server="socks5://localhost:1080"

# Windows
chrome.exe --proxy-server="socks5://localhost:1080"
```

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `application.yml`:

```yaml
segment:
  blockSize: 200      # –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (–±–∞–π—Ç)
  segmentSize: 50     # –†–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (–±–∞–π—Ç)
  delayMs: 30         # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ (–º—Å)
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –î–ª—è –æ–±—Ö–æ–¥–∞ DPI: `blockSize=200, segmentSize=50, delayMs=30`
- –î–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏: `blockSize=100, segmentSize=100, delayMs=10`
- –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏: `blockSize=500, segmentSize=25, delayMs=50`

## üìù –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection refused"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ –ø—Ä–æ–∫—Å–∏
ps aux | grep java

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —Å–ª—É—à–∞–µ—Ç –ª–∏ –ø–æ—Ä—Ç
netstat -an | grep 1080
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Upstream connection failed"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å upstream –ø—Ä–æ–∫—Å–∏
curl --socks5 127.0.0.1:9050 https://check.torproject.org

# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Tor –∑–∞–ø—É—â–µ–Ω
systemctl status tor
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞
```bash
# –£–º–µ–Ω—å—à–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ application.yml
# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é direct –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–∞–π—Ç–æ–≤
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∞–≤–∏–ª–∞ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å regex –≤ —Ñ–∞–π–ª–∞—Ö –ø—Ä–∞–≤–∏–ª
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ resources/
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–∫—Å–∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–∫—Å–∏
curl -x socks5h://127.0.0.1:1080 http://ifconfig.me

# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª
cat src/main/resources/*.txt | grep -v "^#" | grep -v "^$"

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
time curl -x socks5h://127.0.0.1:1080 http://ya.ru > /dev/null

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª
java -jar build/libs/net_6_socks-1.0-SNAPSHOT-all.jar 1080 direct 2>&1 | tee proxy.log
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
.
‚îú‚îÄ‚îÄ build.gradle                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ README.md                    # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ test-proxy.sh               # –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ src/main/
‚îÇ   ‚îú‚îÄ‚îÄ java/                   # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îî‚îÄ‚îÄ resources/
‚îÇ       ‚îú‚îÄ‚îÄ application.yml     # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ blacklist.txt       # –ü—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
‚îÇ       ‚îú‚îÄ‚îÄ whitelist.txt       # –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
‚îÇ       ‚îú‚îÄ‚îÄ redirect.txt        # –ü—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ segment.txt         # –ü—Ä–∞–≤–∏–ª–∞ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ build/libs/                 # –°–æ–±—Ä–∞–Ω–Ω—ã–π JAR (–ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏)
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É
3. **Upstream –ø—Ä–æ–∫—Å–∏:** –ù—É–∂–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã redirect —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
4. **DNS:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `socks5h://` –≤ curl –¥–ª—è —Ä–µ–∑–æ–ª–≤–∞ DNS —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
5. **HTTPS:** –ü—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ TCP, SSL/TLS –ø—Ä–æ–∑—Ä–∞—á–Ω—ã

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –∫—É—Ä—Å–∞ "–°–µ—Ç–µ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏"

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

Pyatkin - Network Technologies Course 2024